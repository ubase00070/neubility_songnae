<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë‹¤ì¤‘ ëª¨ë‹ˆí„°ë§ êµëŒ€ í…ìŠ¤íŠ¸ ì…ë ¥ê¸°</title>
    <style>
        /* 1. ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë° ë°°ê²½ (ì•„ì´ë³´ë¦¬ í†¤ ì ìš©) */
        body { 
            font-family: 'Malgun Gothic', sans-serif; 
            padding: 15px; 
            background-color: #EFE9D9; /* ë¶€ë“œëŸ¬ìš´ ìƒ‰ìƒ */
            color: #333; 
            margin: 0; 
        }
        
        .main-wrapper { 
            display: grid; 
            gap: 15px; 
            max-width: 1400px; 
            margin: auto;
            grid-template-areas: 
                "person preview"
                "units units"
                "extra extra";
            grid-template-columns: 1fr 400px; 
        }

        .person-section { grid-area: person; }
        .preview-section { grid-area: preview; }
        .units-section { grid-area: units; }
        .extra-section { grid-area: extra; }

        .section { 
            background: #FDFCF0; padding: 15px; border-radius: 12px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.03); border: 1px solid #e9e4d9;
            height: fit-content;
        }
        
        .half-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .section-title { font-weight: bold; display: block; color: #495057; border-left: 4px solid #adb5bd; padding-left: 8px; font-size: 0.85rem; }

        /* 2. ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ì• ë‹ˆë©”ì´ì…˜ ì œê±° ë° í¬ê¸° ê³ ì •) */
        button.unit-btn { 
            padding: 5px 9px; border: 1px solid #e9ecef; background: #fff; 
            cursor: pointer; border-radius: 4px; font-size: 12px; color: #444;
            border-bottom-width: 4px !important; border-bottom-style: solid !important;
            box-sizing: border-box;
            transition: background-color 0.1s; 
            transform: none !important;
            margin: 2px;
        }
        
        button.unit-btn:hover:not(:disabled) { background: #f8f9fa; transform: none !important; }
        
        /* í™œì„±í™” ì‹œ í…Œë‘ë¦¬ ë‘ê»˜ë¥¼ ìœ ì§€í•˜ì—¬ ë°€ë¦¼ ë°©ì§€ */
        button.unit-btn.active { 
            border: 1px solid #222 !important; 
            border-bottom-width: 4px !important;
            font-weight: bold !important; 
            background-color: #4dabf7 !important; 
            color: white !important;
            box-shadow: inset 0 0 0 1px #222;
        }
        button.unit-btn:disabled:not(.active) { opacity: 0.3; cursor: not-allowed; }

        /* ì‹œê°„ëŒ€ë³„ ì»¬ëŸ¬ë°” */
        .time-07 { border-bottom-color: #fff3bf !important; } .time-08 { border-bottom-color: #ffe066 !important; }
        .time-09 { border-bottom-color: #fab005 !important; } .time-11 { border-bottom-color: #a9e34b !important; }
        .time-13 { border-bottom-color: #69db7c !important; } .time-14 { border-bottom-color: #38d9a9 !important; }
        .time-15 { border-bottom-color: #3bc9db !important; } .time-18 { border-bottom-color: #4dabf7 !important; }
        .time-20 { border-bottom-color: #748ffc !important; } .time-22 { border-bottom-color: #91a7ff !important; }
        .time-23 { border-bottom-color: #be4bdb !important; } .time-none { border-bottom-color: #dee2e6 !important; }

        /* 3. í”„ë¦¬ë·° ì˜ì—­ ë° ë³µì‚¬ ë²„íŠ¼ ì´ë™ */
        .preview-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        
        #preview { 
            background: #fafaf8; color: #212529; border: 1px solid #e9e4d9; 
            border-radius: 8px; padding: 15px; white-space: pre-wrap; 
            font-family: 'Consolas', monospace; font-size: 14px; line-height: 1.6; 
            min-height: 180px; /* ë†’ì´ ì¶•ì†Œ */
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.02); 
        }

        .copy-btn { 
            padding: 4px 12px; background: #37b24d; color: white; border: none; 
            border-radius: 6px; font-size: 12px; font-weight: bold; cursor: pointer; 
            transition: background 0.2s;
        }
        .copy-btn.is-active { background-color: #4dabf7 !important; }

        .user-save-zone { font-size: 12px; display: flex; align-items: center; gap: 8px; background: #f1f3f5; padding: 6px 12px; border-radius: 4px; border: 1px solid #dee2e6; }
        .user-save-zone input[type="text"] { border: 1px solid #ced4da; border-radius: 3px; padding: 3px 8px; width: 80px; font-size: 12px; }
        .reset-btn { font-size: 11px; padding: 2px 6px; background: #fff; border: 1px solid #dee2e6; border-radius: 4px; cursor: pointer; color: #868e96; }
        .manual-section { margin-top: 15px; padding: 15px; background-color: #fff; border: 1px dashed #e9e4d9; border-radius: 12px; font-size: 13px; line-height: 1.6; color: #495057; }
    </style>
</head>
<body>

<div class="main-wrapper">
    <div class="section person-section">
        <div class="section-header">
            <span class="section-title">1. êµëŒ€ ì¸ì› ì„ íƒ</span>
            <div class="user-save-zone">
                <span>ë³¸ì¸ ì´ë¦„:</span>
                <input type="text" id="my-name-input" oninput="handleNameInput()">
            </div>
        </div>
        <div class="btn-group" id="person-container"></div>
    </div>

    <div class="section preview-section">
        <div class="preview-header">
            <span class="section-title" style="border-color: #37b24d;">ì‹¤ì‹œê°„ í…ìŠ¤íŠ¸ í”„ë¦¬ë·°</span>
            <button class="copy-btn" id="copyBtn" onclick="copyToClipboard()">ë³µì‚¬í•˜ê¸°</button>
        </div>
        <div id="preview"></div>
    </div>

    <div class="units-section">
        <div class="half-grid">
            <div class="section">
                <div class="section-header"><span class="section-title">2. êµëŒ€ ê¸°ì²´</span><button class="reset-btn" onclick="resetSection('shift')">ì „ì²´ í•´ì œ</button></div>
                <div class="btn-group" id="shift-container"></div>
            </div>
            <div class="section">
                <div class="section-header"><span class="section-title">3. ì˜ˆì • ê¸°ì²´</span><button class="reset-btn" onclick="resetSection('plan')">ì „ì²´ í•´ì œ</button></div>
                <div class="btn-group" id="plan-container"></div>
            </div>
        </div>
    </div>

<div class="extra-section">
    <div class="half-grid">
        <div class="section">
            <div class="section-header"><span class="section-title">4. ì¶œì°¨ ì˜ˆì •</span><button class="reset-btn" onclick="resetSection('out')">ì „ì²´ í•´ì œ</button></div>
            <div class="btn-group" id="out-container"></div>
        </div>
        <div class="section">
            <div class="section-header"><span class="section-title">5. ë©€í‹° ê³„ì •</span><button class="reset-btn" onclick="resetSection('account')">ì „ì²´ í•´ì œ</button></div>
            <div class="btn-group" id="account-container">
                <button class="unit-btn time-none" id="acc-01" onclick="toggleAccount('01')">ê³„ì • 01</button>
                <button class="unit-btn time-none" id="acc-02" onclick="toggleAccount('02')">ê³„ì • 02</button>
            </div>
        </div>
    </div> 
    <div class="manual-section" style="margin-top: 15px; padding: 15px; background-color: #fff; border: 1px dashed #e9e4d9; border-radius: 12px; font-size: 13px; line-height: 1.6; color: #495057;">
        <div style="font-weight:bold; margin-bottom:8px; color: #222;">ğŸ“˜ ë‹¤ì¤‘ ëª¨ë‹ˆí„°ë§ êµëŒ€ í…ìŠ¤íŠ¸ ì…ë ¥ê¸° v1.1 (260120)</div>
        <div style="display: flex; justify-content: space-between; gap: 20px;">
            <span style="flex: 1;"><strong>  â€¢ </strong> ë³¸ì¸ ì´ë¦„ ì…ë ¥ ì‹œ ìë™ ì €ì¥ë˜ê³  ê´€ì œì‚¬ë“¤ì€ 07ì‹œë¶€í„° ê·¼ë¬´ì‹œê°„ ê·¸ë£¹ë³„ë¡œ ì§€ì •í–ˆìŠµë‹ˆë‹¤.<br>  â€¢  ë™ì¼ ì‚¬ì´íŠ¸ ê¸°ì²´ëŠ” ìë™ìœ¼ë¡œ ë¬¶ì´ê³  ê¸°ì²´ëŠ” ì„ íƒí•œ ìˆœì„œëŒ€ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤.<br> â€¢ ì‹œê°„ì€ +1Hourë¡œ ìë™ ë°˜ì˜ë˜ë©° ì¶œì°¨ ì˜ˆì •ì€ (êµëŒ€Hour:50)ë¡œ ê³ ì •ë©ë‹ˆë‹¤. <br>  </span>
            <span style="flex: 1;"><strong>  â€¢ </strong> ì‚¬ì‹¤ ì†ìœ¼ë¡œ íƒ€ì´í•‘í•´ë„ ë˜ëŠ” ì¼ì´ì§€ë§Œ, ë¬¸ë“ 'ì•„... íƒ€ì ì¹˜ê¸° ê·€ì°®ì•„.' ë¼ëŠ” ìƒê°ì´ ë“¤ì–´ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.<br>  â€¢ ì¦ê²¨ì°¾ê¸° í•´ë†“ê³  ì‚¬ìš©í•˜ì‹œë©´ ë˜ê³  í”¼ë“œë°± ìˆ˜ì • ì‹œ ì‚¬ì´íŠ¸ì— ìë™ ë°˜ì˜ë©ë‹ˆë‹¤.</span>
        </div>
    </div>
</div>

<script>
    const personnelData = [{ name: "ì°¨í˜„ëª¨", time: "", class: "time-none" }, { name: "ê¹€ì§€í›ˆ", time: "(0700-1600)(U)", class: "time-07" }, { name: "ì˜¤ì •í›ˆ", time: "(0700-1600)(U)", class: "time-07" }, { name: "ê°•ìƒìœ¤", time: "(0700-1600)(U)", class: "time-07" }, { name: "ë°•ê³„ì›", time: "(0800-1700)(U)", class: "time-08" }, { name: "ë°•íš¨ì„ ", time: "(0800-1700)(U)", class: "time-08" }, { name: "ì‹ ì§€ì„­", time: "(0900-1800)(U)", class: "time-09" }, { name: "ì•ˆí˜œë¦¼", time: "(0900-1800)(U)", class: "time-09" }, { name: "ê¹€ê²½í™˜", time: "(0900-1800)(U)", class: "time-09" }, { name: "ìµœìœ¤í˜", time: "(0900-1800)(U)", class: "time-09" }, { name: "ì´ê¸¸ë²”", time: "(0900-1800)(U)", class: "time-09" }, { name: "ë°•ì€ì„ ", time: "(1100-2000)(U)", class: "time-11" }, { name: "ì†¡ì£¼í˜„", time: "(1100-2000)(U)", class: "time-11" }, { name: "ì¥ì¬ì›", time: "(1100-2000)(U)", class: "time-11" }, { name: "ì´í™˜", time: "(1100-2000)(U)", class: "time-11" }, { name: "ë°•í˜œì˜", time: "(1100-2000)(U)", class: "time-11" }, { name: "ê¹€ë™ì§„", time: "(1100-2000)(U)", class: "time-11" }, { name: "ì‹ ì€ì •", time: "(1300-2200)(U)", class: "time-13" }, { name: "ì‹ í˜„ì² ", time: "(1300-2200)(U)", class: "time-13" }, { name: "ì´ë„ì—°", time: "(1300-2200)(U)", class: "time-13" }, { name: "ë°•íš¨ë¹ˆ", time: "(1400-2300)(U)", class: "time-14" }, { name: "ê¹€ê°€ì€", time: "(1500-2400)(U)", class: "time-15" }, { name: "ì„œí˜•ë¯¼", time: "(1500-2400)(U)", class: "time-15" }, { name: "ìµœì„±í™˜", time: "(1500-2400)(U)", class: "time-15" }, { name: "ë°•ìˆ˜ì—°", time: "(1800-0300)(U)", class: "time-18" }, { name: "ì´ê·œìˆœ", time: "(1800-0300)(U)", class: "time-18" }, { name: "ê°•ì² í™˜", time: "(1800-0300)(U)", class: "time-18" }, { name: "ê¹€ì†Œì—°", time: "(2000-0500)(U)", class: "time-20" }, { name: "ìµœì„ í˜¸", time: "(2000-0500)(U)", class: "time-20" }, { name: "ìµœì •ê¸°", time: "(2000-0500)(U)", class: "time-20" }, { name: "ê³ ìƒì—°", time: "(2200-0700)(U)", class: "time-22" }, { name: "ì„ë‹¤ì—°", time: "(2200-0700)(U)", class: "time-22" }, { name: "ì„ì•„ì—°", time: "(2200-0700)(U)", class: "time-22" }, { name: "ì•ˆëŒ€ê´€", time: "(2330-0830)(U)", class: "time-23" }];
    const rawUnits = ["ìš©ì¸ ê³ ì§„", "ì„œê°•ëŒ€", "ê²½í¬ëŒ€ 1", "ê²½í¬ëŒ€ 2", "ì„±ë‚¨ 200", "ì„±ë‚¨ 201", "ì„±ë‚¨ 202", "ì„±ë‚¨ 203", "ë¶€ì‚° 1", "ë¶€ì‚° 2", "ë¶€ì‚° 3", "ë¶€ì‚° 4", "íŒŒì£¼", "ë¦¬ì„¼ì¸  1", "ë¦¬ì„¼ì¸  2", "í‰íƒ 1", "í‰íƒ 2", "DMZ", "ë¶€ì‚° ì„œë©´", "ë¶€ì²œ ì¤‘ë™", "ê³ ì–‘ ë˜ë¯¸ì•ˆ", "ì¸ë ¥ê°œë°œì›", "ì—˜ìŠ¤ 1", "ì—˜ìŠ¤ 2", "ì†¡ë„ êµ­ìº ", "ìì²´ìˆœì°° 01", "ìì²´ìˆœì°° 02", "ë¶€ê²½ëŒ€", "ê¹€í¬ 1", "ê¹€í¬ 2", "í‰íƒ ì§€ì œ", "ë‘ë£¨ì•„ì´ 3", "ì‰´ë”ìŠ¤", "ì‹ ë™ë°±", "ì²­ë‹´ ë¥´ì—˜", "ì „ì£¼ì²œ", "ì•„ì£¼ëŒ€ 1", "ì•„ì£¼ëŒ€ 2", "ê°•ì›ëŒ€ 1", "ê°•ì›ëŒ€ 2"];
    const outUnitsList = ["ë¶€ì‚° 1", "ë¶€ì‚° 2", "ë¶€ì‚° 3", "ë¶€ì‚° 4", "ì„±ë‚¨ 200", "ì„±ë‚¨ 201", "ì„±ë‚¨ 202", "ì„±ë‚¨ 203", "ìì²´ìˆœì°° 01", "ìì²´ìˆœì°° 02"];
    const unitsOrder = rawUnits.map(u => u.replace("ìì²´ìˆœì°°", "ìì²´ìˆœì°° "));

    let selection = { people: [], shift: [], plan: [], out: [], account: [] };
    let copyTimeout;

    function init() {
        const savedName = localStorage.getItem('monitor_my_name');
        if (savedName) document.getElementById('my-name-input').value = savedName;
        renderContainer('person-container', personnelData.map(p => ({name: p.name, type: 'people', class: p.class})));
        renderContainer('shift-container', unitsOrder.map(name => ({name, type: 'shift', class: 'time-none'})));
        renderContainer('plan-container', unitsOrder.map(name => ({name, type: 'plan', class: 'time-none'})));
        renderContainer('out-container', outUnitsList.map(name => ({name: name.replace("ìì²´ìˆœì°°", "ìì²´ìˆœì°° "), type: 'out', class: 'time-none'})));
        updatePersonButtonsState();
        updatePreview();
    }

    function renderContainer(id, data) {
        const container = document.getElementById(id);
        data.forEach(item => {
            const btn = document.createElement('button');
            btn.className = `unit-btn ${item.class}`;
            btn.textContent = item.name;
            btn.onclick = () => {
                const arr = selection[item.type];
                const idx = arr.indexOf(item.name);
                if (idx > -1) { arr.splice(idx, 1); btn.classList.remove('active'); }
                else {
                    const inputName = document.getElementById('my-name-input').value.trim();
                    const max = (inputName === "") ? 2 : 1;
                    if (item.type === 'people' && arr.length >= max) return;
                    arr.push(item.name); btn.classList.add('active');
                }
                if (item.type === 'people') updatePersonButtonsState();
                updatePreview();
            };
            container.appendChild(btn);
        });
    }

    function handleNameInput() {
        localStorage.setItem('monitor_my_name', document.getElementById('my-name-input').value.trim());
        updatePersonButtonsState();
        updatePreview();
    }

    function resetSection(type) {
        selection[type] = [];
        const selector = type === 'account' ? '#account-container .unit-btn' : `#${type}-container .unit-btn`;
        document.querySelectorAll(selector).forEach(btn => btn.classList.remove('active'));
        updatePersonButtonsState();
        updatePreview();
    }

    function toggleAccount(val) {
        const btn = document.getElementById(`acc-${val}`);
        const idx = selection.account.indexOf(val);
        if (idx > -1) { selection.account.splice(idx, 1); btn.classList.remove('active'); }
        else { selection.account.push(val); selection.account.sort(); btn.classList.add('active'); }
        updatePreview();
    }

    function updatePersonButtonsState() {
        const inputName = document.getElementById('my-name-input').value.trim();
        const maxLimit = (inputName === "") ? 2 : 1;
        document.querySelectorAll('#person-container .unit-btn').forEach(btn => {
            btn.disabled = selection.people.length >= maxLimit && !btn.classList.contains('active');
        });
    }

    function formatUnitsWithGrouping(selectedArray) {
        if (selectedArray.length === 0) return "-";
        const groups = [];
        const processedIndexes = new Set();
        selectedArray.forEach((item, index) => {
            if (processedIndexes.has(index)) return;
            const match = item.match(/^(.*)\s(\d+)$/);
            const baseName = match ? match[1] : item;
            const sameGroup = [];
            selectedArray.forEach((innerItem, innerIndex) => {
                const innerMatch = innerItem.match(/^(.*)\s(\d+)$/);
                if ((innerMatch ? innerMatch[1] : innerItem) === baseName) {
                    sameGroup.push({ num: innerMatch ? innerMatch[2] : "", fullName: innerItem });
                    processedIndexes.add(innerIndex);
                }
            });
            if (sameGroup.length > 1 && sameGroup[0].num !== "") {
                const nums = sameGroup.map(g => g.num).sort((a, b) => parseInt(a) - parseInt(b)).join(", ");
                groups.push(`${baseName} ${nums}`);
            } else { groups.push(sameGroup[0].fullName); }
        });
        return groups.join(" / ");
    }

    // ì´ ë¶€ë¶„ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
    function updatePreview() {
        const nextH = new Date(new Date().getTime() + 3600000).getHours();
        const h = String(nextH).padStart(2, '0');
        const inputName = document.getElementById('my-name-input').value.trim();
        let p1 = "@ë³¸ì¸", p2 = "@ëŒ€ê¸°ì";
        const getP = (name) => { const info = personnelData.find(p => p.name === name); return `@${name}${info ? info.time : ""}`; };
        
        if (inputName !== "") {
            const info = personnelData.find(p => p.name === inputName);
            p1 = `@${inputName}${info ? info.time : ""}`;
            if (selection.people[0]) p2 = getP(selection.people[0]);
        } else {
            if (selection.people[0]) p1 = getP(selection.people[0]);
            if (selection.people[1]) p2 = getP(selection.people[1]);
        }

        // í…ìŠ¤íŠ¸ ë¼ì¸ë“¤ì„ ë°°ì—´ì— ìˆœì„œëŒ€ë¡œ ë‹´ìŠµë‹ˆë‹¤.
        const lines = [
            `[${h}]ì‹œ ë‹¤ì¤‘ ëª¨ë‹ˆí„°ë§ êµëŒ€`,
            `${p1} > ${p2}`,
            `â€¢ êµëŒ€: ${formatUnitsWithGrouping(selection.shift)}`,
            `â€¢ ì˜ˆì •: ${formatUnitsWithGrouping(selection.plan)}`
        ];

        // ì¶œì°¨ê°€ ìˆì„ ë•Œë§Œ ë¼ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤. (ì—¬ë°± ì—”í„° ë°©ì§€)
        if (selection.out.length > 0) {
            lines.push(`â€¢ ì¶œì°¨: (${h}:50) ${formatUnitsWithGrouping(selection.out)}`);
        }

        // ë©€í‹° ê³„ì • ìƒíƒœë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. (ë¯¸ì‚¬ìš© ì‹œì—ë„ ë°”ë¡œ ë‹¤ìŒ ì¤„ì— ì˜¤ë„ë¡ ì„¤ì •)
        const accText = selection.account.length === 0 ? "â€¢ ë©€í‹° ê³„ì • ë¯¸ì‚¬ìš©" : `â€¢ ë©€í‹° ê³„ì • ${selection.account.join(", ")} ì‚¬ìš© ì¤‘`;
        lines.push(accText);

        // join('\n')ì„ ì‚¬ìš©í•˜ì—¬ ê° í•­ëª© ì‚¬ì´ì˜ 'ë¹ˆ ì—”í„° ì¤„'ì„ ì™„ì „íˆ ì—†ì•±ë‹ˆë‹¤.
        document.getElementById('preview').innerText = lines.join('\n');
    }

    function copyToClipboard() {
        const textarea = document.createElement('textarea');
        textarea.value = document.getElementById('preview').innerText;
        document.body.appendChild(textarea); textarea.select();
        document.execCommand('copy'); document.body.removeChild(textarea);

        const btn = document.getElementById('copyBtn');
        if (copyTimeout) clearTimeout(copyTimeout);
        btn.innerText = "ë³µì‚¬ë¨";
        btn.classList.add('is-active');
        copyTimeout = setTimeout(() => {
            btn.innerText = "ë³µì‚¬í•˜ê¸°";
            btn.classList.remove('is-active');
            copyTimeout = null;
        }, 800);
    }

    init();
</script>
</body>
</html>




